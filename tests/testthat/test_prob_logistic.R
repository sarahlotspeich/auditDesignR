library(testthat)
library(auditDesignR)

test_that("xonly probability logistic", 
{
	y = rep(c(0,1), 8)
	mu = rep(rep(c(-0.8472979, -0.5472979),each=2), 4)

	prob <- prob_logistic(y, mu)
	expect_equal(prob, c(0.700000008318687,0.299999991681313,0.633508456236015,0.366491543763985,0.700000008318687,0.299999991681313,0.633508456236015,0.366491543763985,0.700000008318687,0.299999991681313,0.633508456236015,0.366491543763985,0.700000008318687,0.299999991681313,0.633508456236015,0.366491543763985), tolerance=1e-6)
	})

test_that("identical y and mu",
{
	y <- rep(c(0,1), 8)
	mu <- y

	prob <- prob_logistic(y, mu)
	expect_equal(prob, c(0.5,0.731058578630005,0.5,0.731058578630005,0.5,0.731058578630005,0.5,0.731058578630005,0.5,0.731058578630005,0.5,0.731058578630005,0.5,0.731058578630005,0.5,0.731058578630005), tolerance=1e-6)
	})